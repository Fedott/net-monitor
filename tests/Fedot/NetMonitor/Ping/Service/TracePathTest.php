<?php
namespace Fedot\NetMonitor\Ping\Service;

use Fedot\Ping\Service\TracePath;
use PHPUnit_Framework_TestCase;

class TracePathTest extends PHPUnit_Framework_TestCase
{
    public function testParseResult()
    {
        $output = "traceroute to ya.ru (213.180.193.3), 20 hops max, 60 byte packets
 1  192.168.1.1  0.296 ms  0.304 ms  0.324 ms
 2  10.0.196.1  1.244 ms  1.475 ms  1.715 ms
 3  172.18.2.173  72.526 ms  73.651 ms  74.075 ms
 4  172.18.2.33  6.892 ms  7.826 ms  8.850 ms
 5  172.18.2.18  2.652 ms  2.668 ms  3.382 ms
 6  172.18.2.1  1.951 ms  2.019 ms  2.078 ms
 7  192.168.254.77  1.697 ms  1.092 ms  1.037 ms
 8  188.134.127.17  1.332 ms  1.422 ms  1.469 ms
 9  188.134.126.133  1.816 ms  2.985 ms 188.134.126.93  3.004 ms
10  188.234.140.226  1.587 ms 188.234.141.218  1.665 ms 188.234.140.226  1.662 ms
11  194.226.100.90  9.199 ms  9.177 ms  9.269 ms
12  213.180.213.16  14.677 ms  14.369 ms  14.767 ms
13  87.250.239.84  27.799 ms  27.810 ms  26.800 ms
14  * * *
15  * 213.180.193.3  17.531 ms *
16  213.180.193.3  9.911 ms * *
";
        $service = new TracePath();
        $result = $service->parseResult($output);

        $expectedResult = [
            1  => ['0.296', '0.304', '0.324'],
            2  => ['1.244', '1.475', '1.715'],
            3  => ['72.526', '73.651', '74.075'],
            4  => ['6.892', '7.826', '8.850'],
            5  => ['2.652', '2.668', '3.382'],
            6  => ['1.951', '2.019', '2.078'],
            7  => ['1.697', '1.092', '1.037'],
            8  => ['1.332', '1.422', '1.469'],
            9  => ['1.816', '2.985', '3.004'],
            10 => ['1.587', '1.665', '1.662'],
            11 => ['9.199', '9.177', '9.269'],
            12 => ['14.677', '14.369', '14.767'],
            13 => ['27.799', '27.810', '26.800'],
            14 => ['*', '*', '*'],
            15 => ['*', '17.531', '*'],
            16 => ['9.911', '*', '*'],
        ];

        $this->assertEquals($expectedResult, $result);
    }
}
